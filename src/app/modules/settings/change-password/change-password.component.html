<div class="change-password-container card">
  <h3>Change Password</h3>
  <app-loader *ngIf="saving()"></app-loader>
  <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="currentPassword">Current Password</label>
      <input id="currentPassword" type="password" formControlName="currentPassword" />
      <div *ngIf="changePasswordForm.get('currentPassword')?.invalid && changePasswordForm.get('currentPassword')?.touched" class="error-message">
        Current password is required.
      </div>
    </div>

    <div class="form-group">
      <label for="newPassword">New Password</label>
      <input id="newPassword" type="password" formControlName="newPassword" />
      <div *ngIf="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched" class="error-message">
        <span *ngIf="changePasswordForm.get('newPassword')?.errors?.['required']">New password is required.</span>
        <span *ngIf="changePasswordForm.get('newPassword')?.errors?.['minlength']">New password must be at least 8 characters.</span>
      </div>
    </div>

    <div class="form-group">
      <label for="confirmNewPassword">Confirm New Password</label>
      <input id="confirmNewPassword" type="password" formControlName="confirmNewPassword" />
      <div *ngIf="changePasswordForm.get('confirmNewPassword')?.invalid && changePasswordForm.get('confirmNewPassword')?.touched" class="error-message">
        Confirm new password is required.
      </div>
    </div>

    <div *ngIf="changePasswordForm.errors?.['passwordMismatch'] && changePasswordForm.get('confirmNewPassword')?.touched" class="error-message">
      New password and confirmation do not match.
    </div>

    <div *ngIf="error()" class="error-state">{{ error() }}</div>
    <div *ngIf="success()" class="success-state">{{ success() }}</div>

    <app-button type="submit" [loading]="saving()" [disabled]="changePasswordForm.invalid || saving()">Change Password</app-button>
  </form>
</div>
