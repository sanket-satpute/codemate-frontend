@use '../../../../styles/_variables' as v;
@use '_mixins' as m;

.vulnerability-item {
  background-color: var(--surface-card); /* Use surface-card */
  border-radius: v.$border-radius-card; /* Use card border radius */
  padding: v.$space-m; /* Use M spacing */
  margin-bottom: v.$space-s; /* Use S spacing */
  box-shadow: var(--shadow-sm); /* Use shadow-sm CSS variable */
  transition: transform 0.2s ease-in-out;
  border-left: 5px solid transparent;
  color: var(--text-primary); /* Default text color */

  &:hover {
    transform: translateY(-2px);
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: v.$space-s; /* Use S spacing */

    .severity {
      font-weight: v.$font-weight-bold; /* Use bold weight */
      padding: v.$space-xs v.$space-s; /* Use XS and S spacing */
      border-radius: v.$border-radius-btn; /* Use button border radius for badge */
      color: var(--text-color-inverted); /* Use inverted text color */
      font-size: var(--font-size-body-sm); /* Use small body font size */
    }

    .cwe {
      font-size: var(--font-size-body-sm); /* Use small body font size */
      color: var(--text-muted); /* Use muted text color */
    }
  }

  .details {
    .description {
      margin-bottom: v.$space-s; /* Use S spacing */
      color: var(--text-primary);
      line-height: 1.5;
    }

    .location {
      font-size: var(--font-size-body-sm); /* Use small body font size */
      color: var(--text-muted); /* Use muted text color */
      display: flex;
      justify-content: space-between;
    }
  }

  &.severity-high {
    border-left-color: var(--error-color); /* Use error color */
    .severity {
      background-color: var(--error-color);
    }
  }

  &.severity-medium {
    border-left-color: var(--warning-color); /* Use warning color */
    .severity {
      background-color: var(--warning-color);
    }
  }

  &.severity-low {
    border-left-color: var(--info-color); /* Use info color */
    .severity {
      background-color: var(--info-color);
    }
  }
}
