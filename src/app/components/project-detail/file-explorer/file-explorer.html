<div class="file-explorer-container">
  <div class="file-explorer-header">
    <h3 class="title">File Explorer</h3>
    <p class="subtitle">Browse and manage your project files.</p>
  </div>

  <div *ngIf="files.length === 0" class="empty-state">
    <app-empty-state
      icon="fas fa-file-excel"
      title="No Files"
      message="No files found in this project."
    ></app-empty-state>
  </div>

  <div *ngIf="files.length > 0" class="file-list">
    <!-- Placeholder for a recursive tree view -->
    <ng-container *ngTemplateOutlet="fileTreeTemplate; context: { $implicit: fileTree }"></ng-container>

    <ng-template #fileTreeTemplate let-items>
      <div *ngFor="let item of items" class="file-item-wrapper">
        <div *ngIf="item.isFolder" class="folder-item" (click)="toggleFolder(item.name)" (keydown)="toggleFolder(item.name)" tabindex="0" title="Toggle folder view">
          <span class="folder-icon">{{ expandedFolders().has(item.name) ? 'ğŸ“‚' : 'ğŸ“' }}</span>
          <span class="folder-name">{{ item.name }}</span>
        </div>
        <div *ngIf="item.isFile"
             class="file-item"
             [class.selected]="selectedFile?.id === item.id"
             (click)="onFileClick(item)" (keydown)="onFileClick(item)" tabindex="0" title="Open file in code viewer">
          <span class="file-icon">ğŸ“„</span>
          <span class="file-name">{{ item.name }}</span>
        </div>
        <div *ngIf="item.isFolder && expandedFolders().has(item.name)" class="folder-children">
          <ng-container *ngTemplateOutlet="fileTreeTemplate; context: { $implicit: item.children }"></ng-container>
        </div>
      </div>
    </ng-template>
  </div>
</div>
